FuelEff <- read.csv("http://www.biz.uiowa.edu/faculty/jledolter/datamining/FuelEfficiency.csv")
FuelEff
str(FuelEff)
plot(GPM~MPG,data=FuelEff)
plot(GPM~WT,data=FuelEff)
plot(GPM~DIS,data=FuelEff)
plot(GPM~NC,data=FuelEff)
plot(GPM~HP,data=FuelEff)
plot(GPM~ACC,data=FuelEff)
plot(GPM~ET,data=FuelEff)
FuelEff=FuelEff[-1]
FuelEff
m1=lm(GPM~.,data=FuelEff)
summary(m1)
cor(FuelEff)
library(leaps)
X=FuelEff[,2:7]
y=FuelEff[,1]
library(leaps)
X=FuelEff[,2:7]
y=FuelEff[,1]
out=summary(regsubsets(X,y,nbest=2,nvmax=ncol(X)))
tab=cbind(out$which,out$rsq,out$adjr2,out$cp)
tab
m2=lm(GPM~WT,data=FuelEff)
summary(m2)
n=length(FuelEff$GPM)
diff=dim(n)
percdiff=dim(n)
for (k in 1:n) {
train1=c(1:n)
train=train1[train1!=k]
## the R expression "train1[train1!=k]" picks from train1 those
## elements that are different from k and stores those elements in the
## object train.
## For k=1, train consists of elements that are different from 1; that
## is 2, 3, Â…, n.
m1=lm(GPM~.,data=FuelEff[train,])
pred=predict(m1,newdat=FuelEff[-train,])
obs=FuelEff$GPM[-train]
diff[k]=obs-pred
percdiff[k]=abs(diff[k])/obs
}
me=mean(diff)
rmse=sqrt(mean(diff**2))
mape=100*(mean(percdiff))
me   # mean error
rmse # root mean square error
mape # mean absolute percent error
n=length(FuelEff$GPM)
diff=dim(n)
percdiff=dim(n)
for (k in 1:n) {
train1=c(1:n)
train=train1[train1!=k]
m2=lm(GPM~WT,data=FuelEff[train,])
pred=predict(m2,newdat=FuelEff[-train,])
obs=FuelEff$GPM[-train]
diff[k]=obs-pred
percdiff[k]=abs(diff[k])/obs
}
me=mean(diff)
rmse=sqrt(mean(diff**2))
mape=100*(mean(percdiff))
me   # mean error
rmse # root mean square error
mape # mean absolute percent error
fuel.df = FuelEff # making a copy of the data frame because we need to adjust the data
fuel.df$NC = factor(fuel.df$NC) # setting up the independent variable as factor
is.factor(fuel.df$NC) # testing if independent variable is a factor
is.numeric(fuel.df$MPG) # testing if dependent variable is numeric
plot(fuel.df$MPG~fuel.df$NC, xlab="Number of Cylinders",ylab="Miles per Gallon") # setting up a basic boxplot by groups
fuel.mod1 = lm(MPG ~ NC, data = fuel.df)
summary(fuel.mod1)
anova(fuel.mod1)
library(leaps)
reg1<- lm(births$APGAR5~births$ESTGEST)
plot(births$MAGER~births$ESTGEST)
abline(reg1)
library(nutshell)
library(lattice)
data(births2006.smpl)
data(oj.csv)
births <- births2006.smpl
str(births)
summary(births)
library(MASS)
tbl=table(births$DMEDUC,births$DPLURAL)
tbl
chisq.test(tbl)
plot(tbl)
age = births$MAGER
gest = births$ESTGEST
cov(age,gest)
na.rm=TRUE
cor(births$MAGER,births$APGAR5,use="all.obs",method=c("pearson"))
cor(births$MAGER,births$APGAR5,use="complete.obs",method=c("pearson"))
cor(births$ESTGEST,births$DBWT,use="complete.obs",method=c("pearson"))
cor(births$MAGER,births$DMETH_REC,use="complete.obs",method=c("pearson"))
is.integer(births$DMETH_REC)
is.null(births$DMETH_REC)
is.character(births$DMETH_REC)
is.numeric(births$DEMETH_REC)
is.factor(births$DMETH_REC)
births$DMETH_REC=as.numeric(births$DMETH_REC)
is.numeric(births$DMETH_REC)
summary(births$DMETH_REC)
cor(births$MAGER,births$DMETH_REC,use="complete.obs",method=c("pearson"))
aggdata<-aggregate(births, by =list(births$MAGER,births$ESTGEST), FUN=mean, na.rm=TRUE)
plot(births$MAGER,births$APGAR5,main="Scatterplot Maternal Age vs. Apgar",xlab="Maternal Age",ylab="Apgar Values")
plot(births$MAGER,births$DMETH_REC,main="Scatterplot Maternal Age vs. Delivery Method", xlab="Maternal Age",ylab="Delivery Method")
reg1<- lm(births$APGAR5~births$ESTGEST)
plot(births$MAGER~births$ESTGEST)
abline(reg1)
summary(births)
abline(reg1)
reg1<- lm(births$APGAR5~births$ESTGEST)
plot(births$MAGER~births$ESTGEST)
abline(reg1)
plot(births$MAGER~births$ESTGEST)
plot(births$MAGER,births$APGAR5,main="Scatterplot Maternal Age vs. Apgar",xlab="Maternal Age",ylab="Apgar Values")
plot(births$MAGER,births$DMETH_REC,main="Scatterplot Maternal Age vs. Delivery Method", xlab="Maternal Age",ylab="Delivery Method")
plot(births$MAGER,births$APGAR5,main="Scatterplot Maternal Age vs. Apgar",xlab="Maternal Age",ylab="Apgar Values")
plot(births$MAGER,births$DMETH_REC,main="Scatterplot Maternal Age vs. Delivery Method", xlab="Maternal Age",ylab="Delivery Method")
summary(births)
plot(births$DPLURAL,births$DBWT,main="Scatterplot Maternal Age vs. Delivery Method", xlab="DPLURAL",ylab="DBWT")
reg1<- lm(birth$DPLURAL-births$DBWT)
reg1<- lm(birth$DPLURAL~births$DBWT)
reg2<- lm(birth$DPLURAL~births$DBWT)
abline(reg2)
reg1<- lm(births$APGAR5~births$ESTGEST)
reg2<- lm(births$APGAR5~births$ESTGEST)
reg2<- lm(births$DPLURAL~births$DBWT)
reg2<- lm(births$MAGER~births$DMEDUC)
abline(reg2)
plot(births$MAGERL,births$DMEDUC,main="Scatterplot Maternal Age vs. Delivery Method", xlab="DPLURAL",ylab="DBWT")
reg2<- lm(births$MAGER~births$DMEDUC)
abline(reg2)
reg2<- lm(births$MAGER~births$WTGAIN)
abline(reg2)
reg2<- lm(births$MAGER~births$WTGAIN)
abline(reg2)
plot(births$MAGER,births$APGAR5,main="Scatterplot Maternal Age vs. Apgar",xlab="Maternal Age",ylab="Apgar Values")
plot(births$MAGER,births$DMETH_REC,main="Scatterplot Maternal Age vs. Delivery Method", xlab="Maternal Age",ylab="Delivery Method")
reg2<- lm(births$MAGER~births$WTGAIN)
abline(reg2)
plot(reg2)
